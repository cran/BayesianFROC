---
title: "How FROC data arise"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{How_FROC_data_arise}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```


## What is FROC task from which data arise


#### There are three actors for FROC trial:

 - *__Images__*, which contains shadows indicating lesions or noises. Also it is called *__case__*.
 - *__Readers__*, who try to detect lesions from shadows in radiographs. Also it is called *__observer__*
    - Reader assign  his suspicious location with his confidence level to each image.
    - If reader think there is one more lesions then reader can answer several answer for each image, so, the answer is not dichotomous, it differ from the ROC analysis.
 - *__Gold__* *__standard__*, from which one can evaluate reader's suspicious locations are true or false.
 
 In this package, we assume that the each image specified true lesion location which  are evaluated base on the gold standard and reader does not know such locations.

 
 
 
 

### Flow of FROC task



 - Suppose that there is the following image:
 - The red circle indicates lesions ( I am not doctor, it may be not lesion, this is only fictitious assumptions)
 
 
  `r paste0("![Truth](",system.file("image", "aa.jpg", package="BayesianFROC"),")")`
  
  
- Reader mark his suspicious location with the number indicating his confidence level. 
- That is, the yellow triangles means that reader thinks they are lesions with his confidence level which is denoted by the inner number in the yellow triangle.


    `r paste0("![Mark](",system.file("image", "aaa.jpg", package="BayesianFROC"),")")`
    
    
- Evaluate hits 
   - The yellow triangle indicates reader's suspicious location and the one of them is very near the red circle, thus we may conclude it as hit.


    `r paste0("![Hit](",system.file("image", "aaaa.jpg", package="BayesianFROC"),")")`
    
  
- Count false alarms

   -  The other marks are false alarms, because they are far from the true lesion location being represented by the red circles.



    `r paste0("![FalselAlarms](",system.file("image", "aaaaa.jpg", package="BayesianFROC"),")")`
    
    
### Summarizing 

 Confidence Level    | No. of Hits | No. of False alarms
 :-----|----------|-------------
5 = definitely present |  $H_{5}=1$ |  $F_{5}=0$ 
4 = probably present   |  $H_{4}=0$ |  $F_{4}=0$ 
3 = equivocal          |  $H_{3}=0$ |  $F_{3}=1$ 
2 = probably absent    |  $H_{2}=0$ |  $F_{2}=0$ 
1 = questionable       |  $H_{1}=0$ |  $F_{1}=2$ 


Note that this is done only for the one image, and actual trial, there are many images, so number of hits and false alarms are more large.


## The R script for the above data

```{r}
 dat <- list(
#Confidence level.
c = c(5,4,3,2,1), 

#Number of hits for each confidence level.
h = c(1,0,0,0,0),

#Number of false alarms for each confidence level.
f = c(0,0,1,0,2),  

#Number of lesions
NL= 2,   

#Number of images
NI= 1,  

#Number of confidence level
 C= 3
)        
```

Should not run the function with this data.
This data is too small to fit the model.


For multiple reader and multiple case, the notations are little troublesome, so I remain it.


## FROC as Piecewise ROC;

By divide each images to the voxel of interest (VOI) or region of interest (ROI), we can obtain such FROC data. These design is very similar to the ordinary ROC analysis, since each ROI or VOI we only answer the dichotomous answer whether lesion exists or not.

## Appendix ( Not  required to read)

Note that I am not doctor, so the red circles never the actual lesions, it is only need to explain and I marked the red circle blindly. So, the image is probably healthy case. I do not know.

## Now my health is ...

Very very very bad :'-D, I have prurigo nodularis at all my body from head to leg, am I die ?? I want to found job, I had quited the previous job for my bad health, so please give me a job, help me..
